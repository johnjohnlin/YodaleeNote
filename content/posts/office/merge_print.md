---
title: "Word 使用合併列印生成大量文件"
date: 2015-10-10
categories:
- MSoffice
tags:
- word
- excel
- merge print
series: null
---

最近筆者的部隊接教召任務，筆者的任務是幫所有的召員們辦薪餉跟交通費補助，光我一個人就點了大概28萬元的錢，事後遇到要點錢的場合都會覺得很煩，這大概是所謂的「點錢恐懼症」吧XD。
事後交通費核銷需要列印每個人的憑證黏存單，上面要有每個人的姓名、要核銷的金額(大小寫都要有)、單據數量，如果一個一個檔案去改、存檔(以姓名為檔名)，遇上一個連隊近百位召員一定會吃土，小小研究一下，最後用word 裡面的合併列印功能解決了這個問題。  
合併列印可以讓你在文件裡插入一些變數，參照到如 excel 、其他的資料庫檔案，自動把資料庫裡的一筆資料插進變數裡，每筆資料生成一份文件，例如你要寫信給100個人，你只要先把100 人的名字打好，以它為變數，word 就會產生100 份信件，最後的署名都不一樣；以這次的教召為例，我們來試用一下合併列印功能。  
<!--more-->

## 準備資料

先準備文件，把會變動的地方如姓名部份留白；接著準備好資料庫，以方便度來說用 excel 就可以了，第一列打上項目：
* 姓名
* 核銷金額
* 核銷金額(大寫)
* 單據數量
然後把該打的資料都打上去。  

為了做個示範，我就只打一份表格就好，至於人名跟金額我就用一些單純的資料XD，通常會比這個複雜得多：  
![doc](/images/office/mergeprint/doc.png)

excel 的資料庫，應該也能用其他的資料庫  
![data](/images/office/mergeprint/data.png)

準備資料有幾個要點，像是我上面資料數字大寫的部分，如果你是直接選「儲存格格式」去改的話，因為它本質還是數字，參照到word 裡面還是會顯示為數字；在這裡要用  `=text(B2, “[dbnum2]”)`  
`=text(D2, “#00”)` 把它轉成大寫文字，跟加上前綴的0；至於後面的format 為何是這個，老實說我也不知道去哪裡找，我真的覺得 M$ 系列的產品都有這種特性：很好用但是想要進一步深入「為什麼」的時候就會碰壁。  
不然也可以用「儲存格格式」去改，然後把顯示的新台幣大寫文字全部貼到word 再貼回來，讓它變成文字格式，這個方法，如果你原本的數字改掉文字不會跟著改，容易出錯，個人比較不喜歡  

## 連接文件

選「郵件」->「啟動合併列印」->「逐步合併列印精靈」點下去，一步一步來就好了。  

1. 列印就選信件，使用目前打好的信件當起始文件，這部分對應到「郵件」->「選取收件者」。  
2. 選擇收件者其實就是選擇你打好的清單，匯入後會跳出項目選單

在這裡可以把你不要的項目挑掉，例如核銷單據張數為0的人，就不用黏存單了，那我們可以選擇「篩選」，設定「單據數量 != 0」把這類的資料過瀘掉。  
![choose](/images/office/mergeprint/choose.png)

3. 現在插入變數，在想要的地方，選精靈的「其他項目」或是工具列的「插入合併欄位」，選擇要插入的項目，插入的項目會有`<<>>`的醒目提示。  
![insert](/images/office/mergeprint/insert.png)

4.  下一步就可以預覽信件了，一共產生了 3 份，自動代入了所選的欄位，每頁文件都是不同的資料項目。  
![generated](/images/office/mergeprint/generated.png)

5. 最後可以選工具列的「完成與合併」->「編輯個別文件」選全部，把所有產生的文件都列出來，存成獨立的一份文件。  

用這個方法，瞬間就能把要做的文件弄好，而且不容易出錯，這也是我認為最重要的：working hard, after knowing you are working smart，現在的電腦是很不容易出錯的，容易犯錯的都是使用者，所以挑一套不容易出錯的工作方式、工作流程，遠比認真工作更重要。