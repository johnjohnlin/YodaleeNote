---
title: "使用旁通道攻擊攻擊腳踏車"
date: 2017-03-18
categories:
- cryptography
tags:
- cryptography
series: null
---

Bob 和Alice 兩位都是T大的學生，Alice 暗戀Bob 已久，發現Bob 下課在校園間移動，都騎著他那台紅色小腳踏車。  
Alice 於是心生一計：如果她偷走Bob 的腳踏車，Bob 下課找不到腳踏車的時候，她就能騎著腳踏車颯爽出現在Bob 身邊，好心載他一程，以拉近兩人的關係  
問題是Bob 的腳踏車用了密碼鎖，想要破解或試出密碼，或找到大剪剪斷塑膠的部分都不是那麼容易的事，那到底該如何解開密碼鎖，偷走腳踏車呢？  
<!--more-->

這時Alice 靈機一動，想起上週在聽密碼學導論時，教授提到有關旁通道攻擊
（Side Channel Attack, SCA）的內容，為何不能利用旁通道攻擊來破解密碼鎖呢？  

所謂旁通道攻擊，就是**不正攻防禦系統中最強的部分**，像是用暴力法直接試密碼鎖10,000 種不同的組合，或者拿大剪直接斷塑膠，
前者要試很久，後者有點太明目張膽了；反之旁通道攻擊從每次加解密時流出來的資訊，推敲出金鑰全部或部分，
從1996年Kocher那篇 [Timing attacks on implementations of Diffie-Hellman](https://link.springer.com/chapter/10.1007/3-540-68697-5_9)
發表至今，無論從電源消耗、近場輻射，甚至聲音，旁通道攻擊攻破無數數學上完全的密碼系統，那麼腳踏車呢？  

前情提要到此：  
理論還滿簡單的，密碼鎖上有4個0-9的數字，上鎖之後要把數字撥亂，其他人才猜不到真正的密碼；可是，撥亂這件事－或稱亂數產生器－卻不一定有被認真對待。  
Bob 上鎖時，可能大手一轉就以為鎖好了，很可能4個數字轉盤裡面有2到3個都是一起轉的，或者因為Bob 是右撇子，都用右手向右撥，也因此，只要持續記錄Bob 每次鎖車時轉盤上的數字，就可以推測出密碼的數值  
這是Alice 努力不懈每天記下Bob 停腳踏車後密碼鎖的數值：  
```txt
1752 4852 5941 5652 4869 4830 5941 4841
```
 其實結果還滿明顯的，轉的數值真的跟習慣有關，甚至多次轉出一樣的數字，我光用看的都能看出來ABCD 四個數字間的關係，AB 差4 (B-A)，CD差7 (D-C)，BC 比較看不出來，但算眾數的話是差8，如果有更多筆資料就能更精準的看出關係，這可能是我習慣上會四個一起轉之後，CD兩位再轉一些，導致BC差值通常不固定。  
由上猜測，腳踏車的密碼可能是 0429，以及四個數字一起轉的其他結果：1530, 2641……9318，很不巧，0429真的是Bob 的腳踏車鎖密碼。  

試過其他解法，例如假設真正的密碼是ABCD，觀察到的數值是A'B'C'D'，個別數字的距離：X-X' 應該會相當接近才對，
我寫了個小程式去算 0000-9999 取 X-X' 的標準差，然後算所有測試結果的標準差總合，愈小的愈可能是答案。  
後來發現這招沒用，例如密碼0000 被轉成 6688，這樣比起正確的密碼0000，0011這個錯誤解在這個算法下就會勝過0000。  

無論如何，記錄了8組數據就能把10,000組密碼組合縮減到10 組，旁通道攻擊果然有用啊。  
可惜後來Bob 發現腳踏車不見了，就跑去借公共腳踏車(NT)Ubike，功敗垂成不禁讓Alice 感嘆：偷得走心上人的腳踏車，卻偷不走他的心。  

## 反思：  
1. 人類其實不是一個很好的亂數產生器：

就如上面的例子，轉盤轉的數字看似亂數，其實隱藏了內部規則，就像現在請人在1到100中選一個數，大家通常認為人腦選的數字是亂的，
其實受限一些人腦的想法，我想結果應該也不是**真的**[亂數]({{< relref "cryptography1_random.md">}})；
另外，依照人的習慣，轉出來的數字，通常也不會跟原有密碼重複，由這也會流出一些線索。  

2. 如果要比較安全的腳踏車鎖，請使用鑰匙鎖：
密碼鎖上鎖都該用真的亂數產生器產生密碼，或者每次轉密碼不能偷懶，一格一個好好的亂轉。  
其實，每次上鎖都把它轉成 0000 也是不錯防範方式XD  

3. 其實我不確定有沒有更好的攻擊方法
只能從數字的規則中推敲出密碼間的關係，但資料量一多關係就很明顯了，這也是統計的效應：  

> 資料的數量才是重點，就算裡面垃圾很多，透過大量資料也能篩出有意義的資訊

某種程度上來說，統計或Big Data 也是從垃圾裡淘出黃金，算是現代的回收業吧XD。  

## 後記：  
其實幾個月前，我鑰匙型的車鎖不見了，換了新的密碼鎖，多轉了幾次之後，想到這個點子。  
本篇文中的例子，都是這一個星期來，每次停腳踏車時就記錄一次，累積一個星期的資料就猜出密碼了。

當然文中提到的密碼也是真的，只是我現在已經換了一個，所以大家要是看到我的小紅，就別用文中的密碼去試了。  
也要提醒大家，如果看到有人在看你腳踏車密碼鎖，而且過幾天又看到他，很可能他就是要對你的腳踏車實施旁通道攻擊，腦袋中一定響個警鈴：
「噹噹，你的腳踏車正遭受攻擊」，一定要記得換個密碼。  

不過話說回來，我猜直接搬走腳踏車比這個方法容易多了。